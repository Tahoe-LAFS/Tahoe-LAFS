#FIXME: merge david's changes to this file
